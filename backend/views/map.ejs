<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>Naver 지도 표시하기</title>
    <script type="text/javascript"
        src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=py7vaucpvn"></script>
</head>

<body>
    <span id="xy" style="display:none;"><%= xy %></span>
    <span id="start_xy" style="display:none;"><%= xy[0] %></span>
    <span id="goal_xy" style="display:none;"><%= xy[1] %></span>
    <span id="route_xy" style="display:none;"><%= xy[2] %></span>
    <h1>NAVER MAP</h1>
    <div id="map" style="width:100%;height:400px;"></div>
    <script>
      var xy = document.getElementById("xy").innerHTML;
      var start_xy = document.getElementById("start_xy").innerHTML;
      var goal_xy = document.getElementById("goal_xy").innerHTML;
      var route_xy = document.getElementById("route_xy").innerHTML;


      // var start_place = start_place;
       var start = start_xy.split(',');
        var start_place = start_place
        var start_lat = parseFloat(start[1])
        var start_lng = parseFloat(start[0])
        var goal = goal_xy.split(',');
        var goal_place = goal_place
        var goal_lat = parseFloat(goal[1])
        var goal_lng = parseFloat(goal[0])
        var route_xy = route_xy.split(',');
        let lngArr = [];
        let latArr = [];
        for (var i = 0; i < route_xy.length; i++){
          if (i % 2 == 0){
            lngArr.push(route_xy[i]);
          }
          else{
            latArr.push(route_xy[i]);
          }
        }
        const locations = [
            { place: start_place, lat: start_lat, lng: start_lng },
            { place: goal_place, lat: goal_lat, lng: goal_lng },
        ];

        let polylinePath = [];
        var i = 0;
        while (latArr[i]){
          polylinePath.push(new naver.maps.LatLng(parseFloat(latArr[i]), parseFloat(lngArr[i])));
          i = i + 1;
        }

        var map = new naver.maps.Map('map', {
            center: new naver.maps.LatLng((start_lat+goal_lat)/2, (start_lng+goal_lng)/2),
            zoom: 15
        });

        for (var i = 0; i < locations.length; i++) {
                var marker = new naver.maps.Marker({
                    map: map,
                    title: locations[i].place,
                    position: new naver.maps.LatLng(locations[i].lat, locations[i].lng),
                });
            }
    var polyline = new naver.maps.Polyline({
    path: polylinePath,      //선 위치 변수배열
    strokeColor: '#3163EB', //선 색 빨강 #빨강,초록,파랑
    strokeOpacity: 0.7, //선 투명도 0 ~ 1
    strokeWeight: 6,   //선 두께
    map: map           //오버레이할 지도
});

    </script src>
</body>
</html>
